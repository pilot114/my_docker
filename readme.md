### Overview

Docker образы на типовый случаи, а также для демок.

* images - для типичных юзкейсов
    * alpine
        * php - базовый php для микросервисов
        * composer - для установки vendor
        * golang - для компиляции golang проектов
    * nginx - базовый образ для http(s) сервисов
    * grafana - мониторинг
    * php-full - php со всеми полезными расширениями
    * workspace - удобная среда для работы в консоли

* volumes - файлы для примеров типового использования

Все типовые сборки осуществляются через make

Примеры:

    # сбилдить все образы в images
    make build

    # просто запустить index.php
    make php v=$(pwd)/volumes/php_script

    # установить зависимости в директорию проекта (используется cache)
    make composer v=$(pwd)/volumes/php_project
    
    # скомпилировать проект на go
    make go v=$(pwd)/volumes/go_project

    # раздать статику на 8080 порту
    make nginx v=$(pwd)/volumes/html

    # запустить сервис мониторинга на 3000 порту
    make grafana

В качестве параметра 'v' передаётся абсолютный путь до директории.

Рекомендуется заходить в workspace под соответствующим юзером:

    docker exec -it -u workspace CONTAINER_ID zsh

Может оказаться полезным делать экспорт/импорт созданных образов в tar архивы.
Для этого можно использовать команды:

    make export name=backup_images
    make import name=backup_images

Для загрузки измененых образов на gitHub нужно выполнить:

    make push

можно конечно сделать webhook для загрузки образов по коммиту,
но ручной запуск этого процесса более нагляден.

### Заметки

- makefile должен содержать tab вместо space, так работает make

- настроить nginx так, чтобы можно было просто пробросить
папку с конкретными конфигами. Тогда по идее не нужно будет
копипастить типовую настройку nginx в каждый проект.

- Стоит делать ревизию раз в год для обновления версий базовых образов.

### gitLab

https://docs.gitlab.com/omnibus/docker/
